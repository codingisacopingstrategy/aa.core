<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <title>Master-timeline</title>
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
    <script src="jquery.voidplayer.js" type="text/javascript" charset="utf-8"></script>
    <style type="text/css">
        #slider { margin: 10px; }
    </style>
    <script>
        Math._round = Math.round;
        Math.round = function(number, precision)
        {
            precision = Math.abs(parseInt(precision)) || 0;
            var coefficient = Math.pow(10, precision);
            return Math._round(number*coefficient)/coefficient;
        }
        $(document).ready(function() {
            $("body").voidplayer({
                duration: 30,
                loop: true,
            })

            $('#slider').slider({
                max: $("body").voidplayer('duration'),
                animate: true,
                step: 0.1,
                start: function(e) {
                    $("body").voidplayer('pause');
                },
                slide: function(e) {
                    $("body").voidplayer('currentTime', $(this).slider('value'));
                },
                stop: function(e) {
                    console.log($(this).slider('value'));
                    $("body").voidplayer('play');
                },
            });
                
            $("body").bind('play', function(e) { 
                console.log('play');
            }).bind('timeupdate', function(e) { 
                console.log('timeupdate: ' + $(this).voidplayer('currentTime'));
                $("#slider").slider('value', $(this).voidplayer('currentTime'));
                $('#time').text(Math.round($(this).voidplayer('currentTime'), 2) + "/" + $(this).voidplayer('duration')) ;
            }).bind('seeking', function(e) { 
                console.log('seeking');
                $('audio').get(0).currentTime = $(this).voidplayer('currentTime') - $('audio').attr('data-start');
            }).bind('ended', function(e) { 
                console.log('ended');
            });

            $("#play").bind('click', function(e) {
                $('body').voidplayer('play');
                $('audio').get(0).play();
            });
            $("#pause").bind('click', function(e) {
                $('body').voidplayer('pause');
            });
        });
    </script>
</head>
<body>
    <div id="player"></div>
    <div id="slider"></div>
    <div id="time"></div>
    <span id="play">play</span>
    <span id="pause">pause</span>

    <p><audio data-start="15" class="player" controls="controls" src="http://repo.oralsite.stdin.fr/Antonia%20Baehr/antonia%20baehr_edit.ogg" type="audio/ogg" preload="auto"/> 
        Your browser does not support the audio tag.
        </audio></p>
</body>
</html>
