{% extends "aacore/base.html" %}

{% block extrahead %}
    <script>
        $(document).ready(function() {
            //$("section").addClass('ui-widget-content').draggable({ grid: [ 50,50 ] }).resizable({grid: 50});
            $("section").addClass('ui-widget-content').draggable().resizable({grid: 50});

            $("a.edit").click(function() {
                $(this).parent().find("form.source").show();
                $(this).parent().find("article.rendered").hide();
            });

            $("button.cancel").click(function() {
                var $this = $(this);
                $this.parents("section").find("form.source").hide()
                $this.parents("section").find("article.rendered").show();
            });

            $("button.save").click(function(e) {
                e.preventDefault();

                var $this = $(this);
                var content = $this.parents("section").find("textarea").val();

                var post_url = $this.parents("section").attr("data-post-url");
                $.post(post_url, 
                    {
                        'content': content,
                        'page': "{{ page }}",
                    }, function(data) {
                        console.log($this.parents("div.section"));
                        $this.parents("section").find("form.source").hide()
                        $this.parents("section").find("article.rendered").show();

                });
            });
        });
    </script>

    <style type="text/css" media="screen">
        .important {
            color: red;
        }
        pre {
            white-space: pre-line;
            font-size: smaller;
        }
        form.source {
            display: none;
        }
        form.source textarea {
            width: 100%;
            height: 200px;
        }
        section {
            border: 1px solid black;
            width: 300px;
            height: 400px;
            position: absolute !important;
            left: 200px;
            top: 200px;
            font-size: 13px;
            line-height: 17px;
            overflow: hidden;
        }
        article.rendered {
            width: 100%;
            height: 100%;
            overflow: auto;
            box-sizing: content-box;
            -moz-box-sizing: content-box;
            -ms-box-sizing: content-box;
            -webkit-box-sizing: content-box;
        }
        article.rendered div {
            padding: 10px;
        }
    </style>    

{% endblock %}
{% block body %}
<nav>
    <ul>
        <li><a href="{% url aa-page-edit slug=page.name %}">edit</a></li>
        <li><a href="">view history</a></li>
    </ul>
</nav>
<article>
    {{ content|safe }}
</article>

{% endblock %}
